startup_manager_gui.py (v5.7 + Silent-Sync-Erweiterung)

Es enthÃ¤lt:

Funktionsbeschreibung (Zweck und Ablauf)

AbhÃ¤ngigkeiten & Systemvoraussetzungen

ModulÃ¼bersicht (Struktur und interne Logik)

DateiverknÃ¼pfungen & interne AbhÃ¤ngigkeiten

Silent-Sync-Mechanismus

Interaktion mit dem Backend

Ablaufdiagramm (Start bis Gatekeeper-Start)

Fehlerbehandlung & Sicherheit

Schritt-fÃ¼r-Schritt-Anleitung zum Nachbau

Optionale Debug-/Testfunktionen

ğŸ§  1. Zweck & Hauptfunktion

Der Elaris Startup Manager ist ein zentrales Verwaltungs- und Sicherheitswerkzeug
fÃ¼r die Gatekeeper-Umgebung der Elaris-KI.

Er erfÃ¼llt folgende Hauptaufgaben:

IntegritÃ¤tsprÃ¼fung aller sicherheitsrelevanten Dateien (HS, KoDa, Start, Signaturen)

ACL/NTFS-PrÃ¼fung, um Dateisystem-Zugriffe auf den aktuellen Benutzer zu beschrÃ¤nken

Signaturerzeugung und -prÃ¼fung vor dem Start

Baseline-Aktualisierung bei autorisierten Ã„nderungen

Automatische Wiederherstellung nach Reset

Silent-Dateisynchronisation zwischen Backend (Verify-System) und Gatekeeper-Verzeichnis

Manuelle Steuerung Ã¼ber GUI inkl. Loganzeige und Statusfelder

Das Programm wird immer zuerst gestartet, bevor Elaris aktiviert wird.
Es ist somit der erste Kontrollpunkt (â€Preflight Checkâ€œ) vor der eigentlichen Erweckung.

âš™ï¸ 2. Systemvoraussetzungen & AbhÃ¤ngigkeiten
Komponente	Beschreibung
Python	â‰¥ 3.10 (wegen Pathlib, datetime, tkinter-KompatibilitÃ¤t)
Betriebssystem	Windows 10 oder hÃ¶her
NTFS-Dateisystem	erforderlich fÃ¼r BerechtigungsprÃ¼fung (icacls)
Bibliotheken	tkinter, hashlib, json, shutil, subprocess, pathlib, datetime, webbrowser, sys
Externe Module	signature_guard (lokal, prÃ¼ft Signaturen)
Backend-AbhÃ¤ngigkeit	Elaris Verify Backend â€“ sendet --sync-final an diesen Manager
Pfadstruktur	muss im Ordner Elairs_gatekeeper liegen, da relative Pfade verwendet werden

Ordnerstruktur (Minimal):

Elairs_gatekeeper/
â”‚
â”œâ”€â”€ startup_manager_gui.py
â”œâ”€â”€ signature_guard.py
â”œâ”€â”€ generate_signing_key.py
â”œâ”€â”€ signiere_hs.py
â”œâ”€â”€ signiere_koda.py
â”œâ”€â”€ embed_starter_into_hs_v3.py
â”œâ”€â”€ embed_starter_into_koda_v3.py
â”œâ”€â”€ HS_Final.txt
â”œâ”€â”€ KonDa_Final.txt
â”œâ”€â”€ Start_final.txt
â””â”€â”€ ...

ğŸ§© 3. Aufbau & Hauptmodule
Bereich	Funktion
Silent-Sync	Wird beim Aufruf mit --sync-final aktiviert. Dient als stiller EmpfÃ¤nger des Backend-Triggers.
verify_ntfs_permissions()	PrÃ¼ft NTFS-Zugriffsrechte. Nur aktueller Benutzer darf Vollzugriff haben.
update_integrity_baseline()	Erstellt/aktualisiert integrity_baseline.json mit Hashwerten genehmigter Dateien.
reset_system_files()	Setzt HS/KoDa auf Ursprungszustand zurÃ¼ck, lÃ¶scht Log- und SchlÃ¼sseldateien.
auto_initial_signatures()	PrÃ¼ft Signaturen, generiert bei Bedarf neue.
create_integrity_block()	Erstellt integrity_block.json mit Hashvergleich von HS und KoDa.
start_gatekeeper()	Startet Hauptprozess auto_gatekeeper_run.py nach erfolgreicher PrÃ¼fung.
GUI-Komponenten	Anzeigen, Buttons, Logausgabe, Statusfelder (ACL/Signatur).
ğŸ”— 4. DateiabhÃ¤ngigkeiten
Datei	Funktion
HS_Final.txt, KonDa_Final.txt	Hauptdateien der KI-Signaturbasis
HS_Final_embedded_v3.py, KonDa_Final_embedded_v3.py	nach Embed-Vorgang generierte Sicherungsdateien
HS_Final_first.txt, KonDa_Final_first.txt	Backup-Dateien fÃ¼r Restore
signing_key.json	privater SchlÃ¼ssel fÃ¼r HMAC
verify_report.json	letzte SignaturprÃ¼fung
integrity_baseline.json	autorisierte Referenz-Hashes
integrity_block.json	aktuelle Hash-Zusammenfassung
reset_status.json	Zeitstempel des letzten Reset
sync_log.txt, sync_state.json	Silent-Sync-Protokolle
auto_gatekeeper_run.py	Hauptstartmodul von Elaris
signature_guard.py	PrÃ¼ft Signaturen beim Start
ğŸ›°ï¸ 5. Silent-Sync Mechanismus (--sync-final)

Der Mechanismus dient dazu, vom Backend (z. B. aus /verify) einen unsichtbaren Trigger
an den Startup Manager zu senden.

Ablauf:

Das Backend fÃ¼hrt am Ende der IntegritÃ¤tsprÃ¼fung diesen Befehl aus:

subprocess.Popen(["python", "startup_manager_gui.py", "--sync-final"], creationflags=subprocess.CREATE_NO_WINDOW)


Der Startup Manager erkennt den Parameter --sync-final Ã¼ber:

if "--sync-final" in sys.argv:


Er prÃ¼ft, ob im Verzeichnis ein Ordner final_build/ existiert.

Schreibt Ergebnis in:

sync_log.txt â†’ Klartext-Eintrag

sync_state.json â†’ JSON mit Timestamp und Pfad

Beendet sich ohne GUI.

So kann das Backend verifizieren, dass die erzeugten HS/KoDa-Dateien verschoben wurden,
ohne dass der Nutzer etwas sieht.

ğŸ§± 6. Interaktion mit dem Backend
Backend-Endpunkt	Aktion
/verify	verschiebt HS/KoDa in final_build und startet den Startup Manager mit --sync-final
startup_manager_gui.py	empfÃ¤ngt stillen Trigger, prÃ¼ft Existenz, loggt Status
sync_log.txt	dient als Nachweis fÃ¼r erfolgreiches Verschieben
sync_state.json	erlaubt maschinelle Weiterverarbeitung (Monitoring)

Keine RÃ¼ckkommunikation Ã¼ber API! Der Vorgang bleibt einseitig und unsichtbar.

ğŸ”„ 7. Ablaufdiagramm
[User/Backend]
     â”‚
     â”œâ”€â–¶ /verify
     â”‚     â”œâ”€ PrÃ¼ft Dateien
     â”‚     â”œâ”€ Verschiebt HS/KoDa â†’ final_build/
     â”‚     â””â”€ Startet: python startup_manager_gui.py --sync-final
     â”‚
[Startup Manager]
     â”œâ”€ Erkennt --sync-final
     â”œâ”€ PrÃ¼ft final_build/
     â”œâ”€ Loggt Ergebnis â†’ sync_log.txt
     â”œâ”€ Erstellt sync_state.json
     â””â”€ Exit(0)


Beim normalen Start:

startup_manager_gui.py (ohne Parameter)
â”œâ”€ GUI Ã¶ffnen
â”œâ”€ ACL prÃ¼fen
â”œâ”€ Signaturen prÃ¼fen
â”œâ”€ ggf. Auto-Signieren & Embed
â”œâ”€ IntegritÃ¤tsblock erzeugen
â””â”€ Gatekeeper starten

ğŸ§° 8. Fehlerbehandlung & Sicherheit
Bereich	Verhalten
Fehlender Ordner final_build	Warnung im Log, keine GUI
NTFS unsicher	Warnung + visuelle Anzeige
Fehlende Signaturen	automatisches Signieren
Fehlende HS/KoDa	Warnung + kein Gatekeeper-Start
Fehler in Sync	schreibt [ERROR] in Log, beendet mit Exitcode 1

Alle kritischen Aktionen sind durch try/except-BlÃ¶cke abgesichert.

ğŸ§± 9. Nachbau-Anleitung (Schritt fÃ¼r Schritt)

Verzeichnis erstellen

C:\Elaris_Gatekeeper\


Dateien kopieren:

startup_manager_gui.py

signature_guard.py

signiere_hs.py, signiere_koda.py

generate_signing_key.py

embed_starter_into_hs_v3.py

embed_starter_into_koda_v3.py

Python 3.10+ installieren

python --version


Testlauf starten

python startup_manager_gui.py


Backend-Integration aktivieren

Stelle sicher, dass /verify am Ende diesen Aufruf hat:

subprocess.Popen(["python", "startup_manager_gui.py", "--sync-final"], creationflags=subprocess.CREATE_NO_WINDOW)


Ergebnis prÃ¼fen

Nach erfolgreichem Lauf:

sync_log.txt enthÃ¤lt Zeitstempel

sync_state.json zeigt Pfad final_build

ğŸ§  10. Debug & Kontrolle

Sync prÃ¼fen

type sync_log.txt


IntegritÃ¤ts-Hash anzeigen

more integrity_block.json


Baseline autorisieren
GUI-Button: â€ğŸ§± Baseline aktualisierenâ€œ

Fehler beheben

Bei [ERROR] im Log â†’ Datei prÃ¼fen

Bei ACL-Warnung â†’ icacls-Berechtigungen anpassen

âœ… Fazit

Der Startup Manager ist:

ğŸ›¡ Sicherheitsmodul

ğŸ”„ Integrationsschicht

ğŸ“¡ Silent-Receiver

ğŸ§  Automatischer Initialisierer

ğŸ’¬ BedienoberflÃ¤che

Er ist die Schnittstelle zwischen Backend-Verify-System und dem lokalen Gatekeeper
und ermÃ¶glicht so eine unsichtbare, aber vollstÃ¤ndige Kontrolle Ã¼ber Datei-IntegritÃ¤t und Systemstart.